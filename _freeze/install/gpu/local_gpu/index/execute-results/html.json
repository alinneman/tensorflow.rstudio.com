{
  "hash": "ddc11bfe1e937f42d6a2c347ee4e372e",
  "result": {
    "markdown": "---\ntitle: \"Local GPU\"\noutput: \n  html_document:\n    toc_depth: 3\n    toc_float:\n        collapsed: false\ntype: docs\nmenu:\n  main:\n    name: \"Local GPU\"\n    identifier: \"tools-local-gpu\"\n    parent: \"installation-gpu\"\n    weight: 20\naliases:\n  - /installation_gpu.html\n  - /tensorflow/installation_gpu.html\n  - /tensorflow/articles/installation_gpu.html\n  - /tools/installation_gpu.html\n  - /tools/local_gpu\n  - /tools/local_gpu.html\n---\n\n\n\n\n## Overview\n\nTensorFlow can be configured to run on either CPUs or GPUs. The CPU version is much easier to install and configure so is the best starting place especially when you are first learning how to use TensorFlow. Here's the guidance on CPU vs. GPU versions from the TensorFlow website:\n\n- **TensorFlow with CPU support only**. If your system does not have a NVIDIA® GPU, you must install this version. Note that this version of TensorFlow is typically much easier to install (typically, in 5 or 10 minutes), so even if you have an NVIDIA GPU, we recommend installing this version first.\n\n- **TensorFlow with GPU support**. TensorFlow programs typically run significantly faster on a GPU than on a CPU. Therefore, if your system has a NVIDIA® GPU meeting the prerequisites shown below and you need to run performance-critical applications, you should ultimately install this version.\n\nSo if you are just getting started with TensorFlow you may want to stick with the CPU version to start out, then install the GPU version once your training becomes more computationally demanding.\n\nThe prerequisites for the GPU version of TensorFlow on each platform are covered below. Once you've met the prerequisites installing the GPU version in a single-user / desktop environment is as simple as:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\ninstall_tensorflow(version = \"gpu\")\n```\n:::\n\n\nIf you are using Keras you can install both Keras and the GPU version of TensorFlow with:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(keras)\ninstall_keras(tensorflow = \"gpu\")\n```\n:::\n\n\nNote that on all platforms you must be running an NVIDIA® GPU with CUDA® Compute Capability 3.5 or higher in order to run the GPU version of TensorFlow. See the list of [CUDA-enabled GPU cards](https://developer.nvidia.com/cuda-gpus).\n\n## Prerequisties\n\n### Windows\n\nThis article describes how to detect whether your graphics card uses an NVIDIA® GPU:\n\n<http://nvidia.custhelp.com/app/answers/detail/a_id/2040/~/identifying-the-graphics-card-model-and-device-id-in-a-pc>\n\nOnce you've confirmed that you have an NVIDIA® GPU, the following article describes how to install required software components including the CUDA Toolkit v10.0, required NVIDIA® drivers, and cuDNN >= v7.4.1:\n\n<https://www.tensorflow.org/install/gpu#hardware_requirements>\n\nNote that the documentation on installation of the last component (cuDNN v7.4.1) is a bit sparse. Once you join the NVIDIA® developer program and download the zip file containing cuDNN you need to extract the zip file and add the location where you extracted it to your system PATH.\n\n### Ubuntu\n\nThis article describes how to install required software components including the CUDA Toolkit v10.0, required NVIDIA® drivers, and cuDNN >= v7.4.1: \n\n<https://www.tensorflow.org/install/install_linux#nvidia_requirements_to_run_tensorflow_with_gpu_support>\n\nThe specifics of installing required software differ by Linux version so please review the NVIDIA® documentation carefully to ensure you install everything correctly. \n\nThe following section provides as example of the installation commands you might use on Ubuntu 16.04. \n\n#### Ubuntu 16.04 Example\n\nFirst, install the NVIDIA drivers:\n\n```ini\n# Add NVIDIA package repositories\n# Add HTTPS support for apt-key\nsudo apt-get install gnupg-curl\nwget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1604/x86_64/cuda-repo-ubuntu1604_10.0.130-1_amd64.deb\nsudo dpkg -i cuda-repo-ubuntu1604_10.0.130-1_amd64.deb\nsudo apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1604/x86_64/7fa2af80.pub\nsudo apt-get update\nwget http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/nvidia-machine-learning-repo-ubuntu1604_1.0.0-1_amd64.deb\nsudo apt install ./nvidia-machine-learning-repo-ubuntu1604_1.0.0-1_amd64.deb\nsudo apt-get update\n\n# Install NVIDIA driver\n# Issue with driver install requires creating /usr/lib/nvidia\nsudo mkdir /usr/lib/nvidia\nsudo apt-get install --no-install-recommends nvidia-410\n# Reboot. Check that GPUs are visible using the command: nvidia-smi\n```\n\nNext install CUDA Toolkit v10.0 and cuDNN v7.4.1 with:\n\n```ini\n# Install development and runtime libraries (~4GB)\nsudo apt-get install --no-install-recommends \\\n    cuda-10-0 \\\n    libcudnn7=7.4.1.5-1+cuda10.0  \\\n    libcudnn7-dev=7.4.1.5-1+cuda10.0\n```\n \nNote that it's important to download **CUDA 10.0** (rather than CUDA 10.1, which may be the choice initially presented) as v10.0 is what TensorFlow is built against.\n\nYou can see more for the installation [here](https://www.tensorflow.org/install/gpu#linux_setup).\n\n#### Environment Variables\n\nOn Linux, part of the setup for CUDA libraries is adding the path to the CUDA binaries to your `PATH` and `LD_LIBRARY_PATH` as well as setting the `CUDA_HOME` environment variable. You will set these variables in distinct ways depending on whether you are installing TensorFlow on a single-user workstation or on a multi-user server. If you are running RStudio Server there is some additional setup required which is also covered below.\n\nIn all cases these are the environment variables that need to be set/modified in order for TensorFlow to find the required CUDA libraries. For example (paths will change depending on your specific installation of CUDA):\n\n```bash\nexport CUDA_HOME=/usr/local/cuda\nexport LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${CUDA_HOME}/lib64 \nPATH=${CUDA_HOME}/bin:${PATH} \nexport PATH\n```\n\n#### Single-User Installation\n\nIn a single-user environment (e.g. a desktop system) you should define the environment variables within your `~/.profile` file. It's necessary to use `~/.profile` rather than `~/.bashrc`, because `~/.profile` is read by desktop applications (e.g. RStudio) as well as terminal sessions whereas `~/.bashrc` applies only to terminal sessions.\n\nNote that you need to restart your system after editing the `~/.profile` file for the changes to take effect. Note also that the `~/.profile` file will not be read by bash if you have either a `~/.bash_profile` or `~/.bash_login` file.\n\nTo summarize the recommendations above:\n\n- Define CUDA related environment variables in `~/.profile` rather than `~/.bashrc`;\n\n- Ensure that you don't have either a  `~/.bash_profile` or `~/.bash_login` file (as these will prevent bash from seeing the variables you've added into `~/.profile`);\n\n- Restart your system after editing `~/.profile` so that the changes take effect.\n\n#### Multi-User Installation\n\nIn a multi-user installation (e.g. a server) you should define the environment variables within the system-wide bash startup file (`/etc/profile`) so all users have access to them.\n\nIf you are running RStudio Server you need to also provide these variable definitions in an R / RStudio specific fashion (as RStudio Server doesn't execute system profile scripts for R sessions). \n\nTo modify the `LD_LIBRARY_PATH` you use the `rsession-ld-library-path` in the /etc/rstudio/rserver.conf configuration file\n\n*/etc/rstudio/rserver.conf*\n\n```ini\nrsession-ld-library-path=/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64\n```\n\nYou should set the `CUDA_HOME` and `PATH` variables in the /usr/lib/R/etc/Rprofile.site configuration file:\n\n*/usr/lib/R/etc/Rprofile.site*\n\n```r\nSys.setenv(CUDA_HOME=\"/usr/local/cuda\")\nSys.setenv(PATH=paste(Sys.getenv(\"PATH\"), \"/usr/local/cuda/bin\", sep = \":\"))\n```\n\nIn a server environment you might also find it more convenient to install TensorFlow into a system-wide location where all users of the server can share access to it. Details on doing this are covered in the [multi-user installation](#multiple-users) section below.\n\n### Mac OS X\n\nAs of version 1.2 of TensorFlow, GPU support is no longer available on Mac OS X. If you want to use a GPU on Mac OS X you will need to install TensorFlow v1.1 as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\ninstall_tensorflow(version = \"1.1-gpu\")\n```\n:::\n\n\nHowever, before you install you should ensure that you have an NVIDIA® GPU and that you have the required CUDA libraries on your system.\n\nWhile some older Macs include NVIDIA® GPU's, most Macs (especially newer ones) do not, so you should check the type of graphics card you have in your Mac before proceeding. \n\nHere is a list of Mac systems which include built in NVIDIA GPU's:\n\n<https://support.apple.com/en-us/HT204349>\n\nYou can check which graphics card your Mac has via the **System Report** button found within the **About This Mac** dialog:\n\n![](images/mac-gpu.png){.tutorial-illustration .tutorial-illustration-medium}\n\nThe MacBook Pro system displayed above *does not* have an NVIDIA® GPU installed (rather it has an Intel Iris Pro).\n\nIf you do have an NVIDIA® GPU, the following article describes how to install the base CUDA libraries:\n\nhttp://docs.nvidia.com/cuda/cuda-installation-guide-mac-os-x/index.html\n\nYou also need to intall the cuDNN library 5.1 library for OS X from here:\n\nhttps://developer.nvidia.com/cudnn\n\nAfter installing these components, you need to ensure that both CUDA and cuDNN are available to your R session via the `DYLD_LIBRARY_PATH`. This typically involves setting environment variables in your `.bash_profile` as described in the NVIDIA documentation for CUDA and cuDNN.\n\nNote that environment variables set in .bash_profile will not be available by default to OS X desktop applications like R GUI and RStudio. To use CUDA within those environments you should start the application from a system terminal as follows:\n\n```bash\nopen -a R         # R GUI\nopen -a RStudio   # RStudio\n```\n\n\n## Installation\n\n### Single User\n\nIn a single-user desktop environment you can install TensorFlow with GPU support via:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tensorflow)\ninstall_tensorflow(version = \"gpu\")\n```\n:::\n\n\nIf this version doesn't load successfully you should review the prerequisites above and ensure that you've provided definitions of CUDA environment variables as recommended above.\n\nSee the main [installation article](installation.html) for details on other available  options (e.g. virtualenv vs. conda installation, installing development versions, etc.).\n\n### Multiple Users\n\nIn a multi-user server environment you may want to install a system-wide version of TensorFlow with GPU support so all users can share the same configuration. To do this, start by following the directions for native pip installation of the GPU version of TensorFlow here:\n\n<https://www.tensorflow.org/install/install_linux#InstallingNativePip>\n\nThere are some components of TensorFlow (e.g. the [Keras](https://github.com/tensorflow/tensorflow/tree/master/tensorflow/python/keras) library) which have dependencies on additional Python packages.\n\nYou can install Keras and it's optional dependencies with the following command (ensuring you have the correct privilege to write to system library locations as required via sudo, etc.):\n\n```bash\npip install keras h5py pyyaml requests Pillow scipy\n```\n\nIf you have any trouble with locating the system-wide version of TensorFlow from within R please see the section on [locating TensorFlow](installation.html#locating-tensorflow).\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}